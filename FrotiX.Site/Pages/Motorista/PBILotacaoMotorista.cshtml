@* ****************************************************************************************
 * 笞｡ ARQUIVO: Pages/Motorista/PBILotacaoMotorista.cshtml
 * --------------------------------------------------------------------------------------
 * 識 OBJETIVO     : Pﾃ｡gina de exibiﾃｧﾃ｣o dashboard Power BI "Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa"
 *                   (iframe embed read-only) com wrapper responsive 16:9, keydown Enter prevention (anti-submit).
 * 踏 ENTRADAS     : @page route /Motorista/PBILotacaoMotorista, nenhum form input (iframe somente leitura),
 *                   keydown events (preventDefault Enter em input/select/textarea/button)
 * 豆 SAﾃ好AS       : Panel #divPainel com div .pbi-embed responsive (padding-top 56.25% = 16:9 aspect ratio),
 *                   iframe title "Frotix Atualizado - Relatﾃｳrio de Lotaﾃｧﾃｵes dos Motoristas" src Power BI
 *                   (app.powerbi.com/view?r=eyJrIjo... token), allowfullscreen loading lazy, aria-label accessibility,
 *                   @section ScriptsBlock: JavaScript keydown listener preventDefault Enter (evita submit acidental)
 * 迫 CHAMADA POR  : Menu "Grﾃ｡ficos/Relatﾃｳrios > Lotaﾃｧﾃ｣o de Motoristas", route /Motorista/PBILotacaoMotorista,
 *                   sidebar navigation, dashboard widgets, links PBI pages
 * 売 CHAMA        : ViewData (Title "Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa", PageName "taxileg_pbitaxileg"
 *                   ERRADO!, Heading fa-user-tie, Category1 "Grﾃ｡ficos", PageIcon fa-taxi), Syncfusion TagHelper
 *                   (@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers + @using Syncfusion.EJ2 - Nﾃグ usados!),
 *                   toastr.js CDN CSS (@section HeadBlock - Nﾃグ usado!), CSS inline (.form-control-xs, .label,
 *                   input[type=checkbox], .btn-largura, .pbi-embed responsive wrapper 16:9), iframe Power BI
 *                   embedded (app.powerbi.com/view token eyJrIjoiZTBhNjhjMzUtZjA4ZS00ZTA5LTk0NTgtZWMwZTQ3NTI4ZmM5"),
 *                   JavaScript keydown addEventListener ('Enter' preventDefault passive:false), Alerta.TratamentoErroComLinha
 *                   (error handler PBILotacaoMotorista.cshtml linha), console.error fallback
 * 逃 DEPENDﾃ劾CIAS : ASP.NET Core Razor Pages, ViewData, Syncfusion EJ2 (TagHelper registrado mas Nﾃグ usado!),
 *                   toastr.js CDN (registrado @section HeadBlock mas Nﾃグ usado!), Power BI Embedded iframe
 *                   (app.powerbi.com/view public token read-only), CSS responsive .pbi-embed (16:9 padding-top:56.25%
 *                   position relative, iframe position absolute inset:0 width/height 100%), JavaScript
 *                   addEventListener keydown, Alerta.TratamentoErroComLinha (error handler FrotiX custom),
 *                   Font Awesome Duotone (fa-user-tie heading, fa-taxi icon)
 * 統 OBSERVAﾃﾃ髭S  : 101 linhas. Pﾃ｡gina Power BI embed Lotaﾃｧﾃ｣o Motoristas (dashboard visual read-only). ViewData config:
 *                   - Title: "Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa"
 *                   - PageName: "taxileg_pbitaxileg" (**ERRADO!** deve ser "motorista_pbilotacaomotorista" -
 *                     copypaste de TaxiLeg/PBITaxiLeg.cshtml)
 *                   - Heading: "<i class='fa-duotone fa-user-tie'></i> Grﾃ｡ficos: <span class='fw-300'>Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa</span>"
 *                   - Category1: "Grﾃ｡ficos"
 *                   - PageIcon: "fa-duotone fa-taxi"
 *                   @addTagHelper + @using Syncfusion.EJ2 (linha 2-3): **Nﾃグ usados nesta pﾃ｡gina** (sobras copypaste).
 *                   @section HeadBlock: toastr.js CDN CSS link (cdnjs latest) **Nﾃグ usado** (sobra copypaste).
 *                   CSS inline:
 *                   1. .form-control-xs, .label, input[type=checkbox], .btn-largura (100x100px) **Nﾃグ usados** (sobras)
 *                   2. **.pbi-embed** (ATIVO): position relative, width 100%, padding-top 56.25% (16:9 aspect ratio
 *                      formula: 9/16*100%=56.25%), background #f7f7f9, border-radius .25rem, overflow hidden,
 *                      box-shadow inset 0 0 0 1px rgba(0,0,0,.05) (borda sutil inset)
 *                   3. **.pbi-embed iframe** (ATIVO): position absolute, inset:0 (top/right/bottom/left=0), width/height 100%,
 *                      border:0 (remove iframe border)
 *                   Panel #divPainel: div .pbi-embed com aria-label "Relatﾃｳrio Power BI - Lotaﾃｧﾃ｣o de Motoristas por
 *                   Unidade Administrativa" (acessibilidade screen readers). Iframe attributes:
 *                   - title: "Frotix Atualizado - Relatﾃｳrio de Lotaﾃｧﾃｵes dos Motoristas"
 *                   - src: Power BI public embed URL (app.powerbi.com/view?r=eyJrIjoiZTBhNjhjMzUtZjA4ZS00ZTA5LTk0NTgtZWMwZTQ3NTI4ZmM5IiwidCI6ImIwNmM0MGIzLWM5MGItNGYwYS1hNWVjLTlkZTRmMGQzMTEzMCJ9)
 *                   - allowfullscreen="true" (permite F11 fullscreen)
 *                   - loading="lazy" (lazy load iframe para performance)
 *                   @section ScriptsBlock: JavaScript IIFE (Immediately Invoked Function Expression):
 *                   - document.addEventListener('keydown', callback, {passive:false}) (must be non-passive para preventDefault)
 *                   - Verifica key === 'Enter' + tagName ['input','select','textarea','button']
 *                   - e.preventDefault() (previne submit form acidental ao pressionar Enter)
 *                   - Try-catch: Alerta.TratamentoErroComLinha("PBILotacaoMotorista.cshtml", "keydownPreventEnter", error)
 *                     ou console.error fallback (TYPO: "Exception error" deve ser "Exception:", error)
 *                   **PROBLEMAS**:
 *                   1. PageName "taxileg_pbitaxileg" ERRADO (copypaste TaxiLeg, deve ser "motorista_pbilotacaomotorista")
 *                   2. Syncfusion @addTagHelper/@using Nﾃグ usado (remover)
 *                   3. toastr.js CDN Nﾃグ usado (remover @section HeadBlock)
 *                   4. CSS inline Nﾃグ usado (remover .form-control-xs, .label, checkbox, .btn-largura)
 *                   5. TYPO console.error: "Exception error" deve ser "Exception:", error
 *                   6. Power BI token eyJrIjo... (JSON Web Token base64): pode expirar se nﾃ｣o renovado!
 *                   7. keydown prevention GLOBAL (aplica a TODA pﾃ｡gina - pode bloquear Enter legﾃｭtimo em modals/search)
 **************************************************************************************** *@
@page
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using Syncfusion.EJ2

@{
ViewData["Title"] = "Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa";
ViewData["PageName"] = "taxileg_pbitaxileg";
ViewData["Heading"] = "<i class='fa-duotone fa-user-tie'></i> Grﾃ｡ficos: <span class='fw-300'>Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa</span>";
ViewData["Category1"] = "Grﾃ｡ficos";
ViewData["PageIcon"] = "fa-duotone fa-taxi";
}

@section HeadBlock {
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />
}

<style>
    .form-control-xs {
        height: calc(1em + .775rem + 2px) !important;
        padding: .125rem .25rem !important;
        font-size: .75rem !important;
        line-height: 1.5;
        border-radius: .2rem;
    }

    .label {
        margin-bottom: -5px;
        margin-top: 10px;
    }

    input[type=checkbox] {
        vertical-align: middle;
        position: relative;
        bottom: 1px;
    }

    .btn-largura {
        width: 100px;
        height: 100px;
    }

    /* Wrapper responsivo para o Power BI */
    .pbi-embed {
        position: relative;
        width: 100%;
        /* Proporﾃｧﾃ｣o ~ 16:9 */
        padding-top: 56.25%;
        background: #f7f7f9;
        border-radius: .25rem;
        overflow: hidden;
        box-shadow: inset 0 0 0 1px rgba(0,0,0,.05);
    }

        .pbi-embed iframe {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
</style>

<div class="row">
    <div class="col-xl-12">
        <div id="panel-1" class="panel">
            <div class="panel-container show">
                <div id="divPainel" class="panel-content">
                    <div class="pbi-embed" aria-label="Relatﾃｳrio Power BI - Lotaﾃｧﾃ｣o de Motoristas por Unidade Administrativa">
                        <iframe title="Frotix Atualizado - Relatﾃｳrio de Lotaﾃｧﾃｵes dos Motoristas"
                                src="https://app.powerbi.com/view?r=eyJrIjoiZTBhNjhjMzUtZjA4ZS00ZTA5LTk0NTgtZWMwZTQ3NTI4ZmM5IiwidCI6ImIwNmM0MGIzLWM5MGItNGYwYS1hNWVjLTlkZTRmMGQzMTEzMCJ9"
                                allowfullscreen="true"
                                loading="lazy">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section ScriptsBlock {
<script>
    // Evita submit acidental com Enter em inputs (se adicionados futuramente)
    (function () {
        try {
            document.addEventListener('keydown', function (e) {
                const tag = (e.target?.tagName || '').toLowerCase();
                if (e.key === 'Enter' && ['input', 'select', 'textarea', 'button'].includes(tag)) {
                    e.preventDefault();
                }
            }, { passive: false });
        } catch (error) {
            if (window.Alerta?.TratamentoErroComLinha) {
                Alerta.TratamentoErroComLinha("PBILotacaoMotorista.cshtml", "keydownPreventEnter", error);
            } else {
                console.error(Exception error);
            }
        }
    })();
</script>
}
