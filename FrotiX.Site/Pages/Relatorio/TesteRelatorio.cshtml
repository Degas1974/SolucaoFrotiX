@* ****************************************************************************************
 * 笞｡ ARQUIVO: Pages/Relatorio/TesteRelatorio.cshtml
 * --------------------------------------------------------------------------------------
 * 識 OBJETIVO     : Pﾃ｡gina de TESTE Telerik Report Viewer (relatﾃｳrio Viagem.trdp hardcoded NoFichaVistoria: 93408),
 *                   div #reportViewer1 width 75% height 700px, Kendo UI 2022.1.412 CDN **DUPLICADO** @section
 *                   HeadBlock + ScriptsBlock (PROBLEMA!), telerikReportViewer PRINT_PREVIEW scale 1.0.
 * 踏 ENTRADAS     : @page route /Relatorio/TesteRelatorio, Kendo UI CDN 2022.1.412 (jquery.min.js, jszip.min.js,
 *                   kendo.all.min.js, kendo.aspnetmvc.min.js, kendo.default-main.min.css), pdf.js 2.2.2 (CDN),
 *                   form onkeypress stopEnterSubmitting (DECLARADO mas Nﾃグ implementado!), nenhum input form
 * 豆 SAﾃ好AS       : Panel #divPainel, div d-flex height 700px, div #reportViewer1 width 75% "Loading...",
 *                   @section ScriptsBlock: Kendo UI CDN **DUPLICADO** (mesmos includes @section HeadBlock!), Telerik
 *                   Report Viewer script (/api/reports/resources/js/telerikReportViewer), jQuery ready
 *                   $("#reportViewer1").telerik_ReportViewer (serviceUrl "/api/reports/", reportSource
 *                   {report:'Viagem.trdp', parameters:{NoFichaVistoria:93408}}, viewMode PRINT_PREVIEW, scaleMode
 *                   SPECIFIC scale 1.0, enableAccessibility false, sendEmail enabled true)
 * 迫 CHAMADA POR  : **PROVAVELMENTE Nﾃグ USADO** - route /Relatorio/TesteRelatorio (teste developer), nﾃ｣o deve existir
 *                   menu link (teste/mockup Telerik Reporting)
 * 売 CHAMA        : ViewData (Title "Viagens", PageName "viagem_index" ERRADO!, Heading fa-route, Category1
 *                   "Cadastros", PageIcon fa-route), @addTagHelper*, @using Syncfusion.EJ2 (Nﾃグ usados! Syncfusion
 *                   registrado mas sﾃｳ Telerik/Kendo usado), @Html.AntiForgeryToken (Nﾃグ usado! sem form submit),
 *                   form asp-action="FichasAntigas" method POST (Nﾃグ submetido! sem inputs, sem JavaScript submit),
 *                   onkeypress stopEnterSubmitting (DECLARADO mas Nﾃグ implementado! funﾃｧﾃ｣o Nﾃグ existe), Kendo UI CDN
 *                   2022.1.412 **DUPLICADO** (kendostatic.com jquery/jszip/kendo.all/kendo.aspnetmvc CSS+JS @section
 *                   HeadBlock + ScriptsBlock AMBOS - PROBLEMA 2x carregamento!), pdf.js 2.2.2 (cdnjs.cloudflare.com
 *                   pdf.js + pdf.worker.js + pdfjsLib.GlobalWorkerOptions.workerSrc config **DUPLICADO**),
 *                   /api/reports/resources/js/telerikReportViewer (Telerik Report Viewer client script), /api/reports/
 *                   (Telerik Report Server API endpoint), Viagem.trdp (Telerik report definition file - TRDP format),
 *                   NoFichaVistoria: 93408 (hardcoded parameter value - ficha vistoria ID especﾃｭfico teste),
 *                   telerikReportViewer.ViewModes.PRINT_PREVIEW, telerikReportViewer.ScaleModes.SPECIFIC,
 *                   CSS inline (.form-control-xs, .label, input[type=checkbox], .btn-largura 100x100 Nﾃグ usados!)
 * 逃 DEPENDﾃ劾CIAS : ASP.NET Core Razor Pages, ViewData, @addTagHelper* (Nﾃグ usado Syncfusion!), Kendo UI 2022.1.412
 *                   (jquery/jszip/kendo.all/kendo.aspnetmvc/kendo.default-main CSS), **Telerik Reporting** (telerik_ReportViewer
 *                   jQuery plugin, /api/reports/ service, .trdp report definition), pdf.js 2.2.2 (PDF rendering
 *                   worker), CSS inline (Nﾃグ usado!), Bootstrap 5 (d-flex height), jQuery ready
 * 統 OBSERVAﾃﾃ髭S  : 111 linhas. Pﾃ｡gina TESTE/MOCKUP Telerik Reporting (nﾃ｣o finalizada). ViewData config:
 *                   - Title: "Viagens" (genﾃｩrico)
 *                   - PageName: "viagem_index" (ERRADO! deve ser "relatorio_testerelatorio")
 *                   - Heading: "<i class='fa-duotone fa-route'></i> Cadastros: <span class='fw-300'>Viagens</span>"
 *                   - Category1: "Cadastros"
 *                   - PageIcon: "fa-duotone fa-route"
 *                   @addTagHelper*, @using Syncfusion.EJ2 (linha 2-3): **Nﾃグ usados!** (Syncfusion registrado mas
 *                   pﾃ｡gina usa Telerik/Kendo - confusﾃ｣o copypaste). @Html.AntiForgeryToken linha 4 (Nﾃグ usado! form
 *                   nﾃ｣o submeta). CSS inline (Nﾃグ usado): .form-control-xs, .label, checkbox, .btn-largura (sobras
 *                   copypaste - remover). @section HeadBlock: toastr/microtip links COMENTADOS, **Kendo UI 2022.1.412
 *                   CDN carregado COMPLETO** (CSS + 5 JS: jquery/jszip/kendo.all/kendo.aspnetmvc + pdf.js 2.2.2 +
 *                   pdfjsLib.GlobalWorkerOptions). Form method POST asp-action="FichasAntigas" (Nﾃグ existe! deve ser
 *                   asp-page handler) onkeypress stopEnterSubmitting (FUNﾃﾃグ Nﾃグ IMPLEMENTADA! JavaScript Nﾃグ define
 *                   stopEnterSubmitting - erro runtime se Enter pressionado) enctype multipart/form-data (Nﾃグ usado).
 *                   Panel #divPainel: div d-flex height 700px (fixed), div #reportViewer1 width 75% pb-3 "Loading..."
 *                   (placeholder texto - substituﾃｭdo por Telerik viewer). @section ScriptsBlock: **PROBLEMA CRﾃ控ICO**
 *                   Kendo UI 2022.1.412 CDN **DUPLICADO COMPLETO** (mesmos 5 JS + CSS + pdf.js jﾃ｡ carregados @section
 *                   HeadBlock - CARREGAMENTO 2x desnecessﾃ｡rio! remover daqui, manter sﾃｳ HeadBlock). Script
 *                   /api/reports/resources/js/telerikReportViewer (Telerik Report Viewer client). jQuery ready:
 *                   $("#reportViewer1").telerik_ReportViewer config:
 *                   - serviceUrl: "/api/reports/" (Telerik Report Server API - backend deve implementar)
 *                   - reportSource: {report:'Viagem.trdp', parameters:{NoFichaVistoria:93408}} (hardcoded ID 93408 TESTE!)
 *                   - viewMode: telerikReportViewer.ViewModes.PRINT_PREVIEW (modo impressﾃ｣o preview)
 *                   - scaleMode: telerikReportViewer.ScaleModes.SPECIFIC, scale: 1.0 (zoom 100%)
 *                   - enableAccessibility: false (desabilita features acessibilidade)
 *                   - sendEmail: {enabled: true} (botﾃ｣o enviar email relatﾃｳrio)
 *                   **PROBLEMAS CRﾃ控ICOS**:
 *                   1. **Kendo UI CDN DUPLICADO** (@section HeadBlock + ScriptsBlock - carrega 2x! remover ScriptsBlock)
 *                   2. **stopEnterSubmitting Nﾃグ implementado** (form onkeypress chama funﾃｧﾃ｣o inexistente - erro!)
 *                   3. **NoFichaVistoria hardcoded 93408** (teste value - deve ser dinﾃ｢mico via Model/query string)
 *                   4. **Syncfusion Nﾃグ usado** (@addTagHelper/@using Syncfusion mas sﾃｳ Telerik usado - remover)
 *                   5. **AntiForgeryToken Nﾃグ usado** (form nﾃ｣o submeta)
 *                   6. **Asp-action "FichasAntigas" Nﾃグ existe** (deve ser asp-page-handler ou remover form)
 *                   7. **CSS inline Nﾃグ usado** (remover)
 *                   8. **PageName ERRADO** ("viagem_index" deve ser "relatorio_testerelatorio")
 *                   9. **Arquivo TESTE** (provavelmente DELETE ou finalizar implementaﾃｧﾃ｣o para produﾃｧﾃ｣o)
 *                   **TELERIK REPORTING**: Requer Telerik Reporting Server backend (/api/reports/ endpoints),
 *                   .trdp report files (Telerik Report Designer format), licenﾃｧa comercial Telerik.
 **************************************************************************************** *@
@page
@addTagHelper*, Microsoft.AspNetCore.Mvc.TagHelpers
@using Syncfusion.EJ2
@Html.AntiForgeryToken()

@{
    ViewData["Title"] = "Viagens";
    ViewData["PageName"] = "viagem_index";
    ViewData["Heading"] = "<i class='fa-duotone fa-route'></i> Cadastros: <span class='fw-300'>Viagens</span>";
    ViewData["Category1"] = "Cadastros";
    ViewData["PageIcon"] = "fa-duotone fa-route";
}

<style>
    .form-control-xs {
        height: calc(1em + .775rem + 10px) !important;
        padding: .125rem .25rem !important;
        font-size: .75rem !important;
        line-height: 1.5;
        border-radius: .2rem;
    }

    .label {
        margin-bottom: -5px;
        margin-top: 10px;
    }

    input[type=checkbox] {
        vertical-align: middle;
        position: relative;
        bottom: 1px;
    }

    .btn-largura {
        width: 100px;
        height: 100px;
    }
</style>

@section HeadBlock {
    @* <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" /> *@
    @* <link rel="stylesheet" href="~/css/microtip.css" /> *@

    <link href="https://cdn.kendostatic.com/2022.1.412/styles/kendo.default-main.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.kendostatic.com/2022.1.412/js/jquery.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/jszip.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/kendo.all.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/kendo.aspnetmvc.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/cultures/kendo.culture.pt-BR.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/messages/kendo.messages.pt-BR.min.js"></script>
    <script>
        try {
            if (window.kendo && kendo.culture) {
                kendo.culture("pt-BR");
            }
        } catch (error) {
            console.warn("Kendo pt-BR: falha ao aplicar cultura.", error);
        }
    </script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/cultures/kendo.culture.pt-BR.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/messages/kendo.messages.pt-BR.min.js"></script>
    <script>
        try {
            if (window.kendo && kendo.culture) {
                kendo.culture("pt-BR");
            }
        } catch (error) {
            console.warn("Kendo pt-BR: falha ao aplicar cultura.", error);
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.2.2/pdf.js"></script>
    <script>
        window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.2.2/pdf.worker.js';
    </script>


}

<form method="post" asp-action="FichasAntigas" onkeypress='stopEnterSubmitting(window.event)' enctype="multipart/form-data">
    <div class="row">
        <div class="col-xl-12">
            <div id="panel-1" class="panel">
                <div class="panel-container show">
                    <div id="divPainel" class="panel-content">

                        <div class="d-flex" style="height:700px">
                            <div id="reportViewer1" style="width:75%" class="pb-3">
                                Loading...
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</form>


@section ScriptsBlock
{

    <link href="https://cdn.kendostatic.com/2022.1.412/styles/kendo.default-main.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.kendostatic.com/2022.1.412/js/jquery.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/jszip.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/kendo.all.min.js"></script>
    <script src="https://cdn.kendostatic.com/2022.1.412/js/kendo.aspnetmvc.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.2.2/pdf.js"></script>
    <script>
        window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.2.2/pdf.worker.js';
    </script>

    <script src="/api/reports/resources/js/telerikReportViewer"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#reportViewer1")
                .telerik_ReportViewer({
                    serviceUrl: "/api/reports/",
                    reportSource: {
                        report: 'Viagem.trdp',
                        parameters: { NoFichaVistoria: 93408 }
                    },
                    viewMode: telerikReportViewer.ViewModes.PRINT_PREVIEW,
                    scaleMode: telerikReportViewer.ScaleModes.SPECIFIC,
                    scale: 1.0,
                    enableAccessibility: false,
                    sendEmail: { enabled: true }
                });
        });
    </script>

}
