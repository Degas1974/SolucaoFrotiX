<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Usuarios - Upsert | FrotiX</title>
  <style>
    :root {
      --vinho: #722F37;
      --vinho-light: #8B3A44;
      --azul: #325d88;
      --azul-light: #3d6f9e;
      --terracota: #A97B6E;
      --terracota-light: #C08B7E;
      --verde: #557570;
      --verde-light: #6A8A85;
      --cinza: #e8eaed;
      --card: #ffffff;
      --texto: #1f1f1f;
      --shadow: 0 20px 45px -18px rgba(0, 0, 0, .35);
      --radius: 14px;
      --header-bg: #b66a3d;
      --code-bg: #33465c;
    }
    @page { size: A4; margin: 15mm; }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", "Inter", system-ui, -apple-system, sans-serif;
      background: var(--cinza);
      color: var(--texto);
      padding: 28px;
      max-width: 210mm;
      min-height: 297mm;
    }
    .hero {
      background: var(--header-bg);
      color: #fff;
      padding: 26px 28px;
      border-radius: var(--radius);
      box-shadow: 0 0 0 1px #000, 0 0 0 4px #fff, var(--shadow);
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .hero img { width: 50px; height: 50px; filter: drop-shadow(0 6px 8px rgba(0,0,0,.25)); }
    h1 { margin: 0; font-size: 26px; letter-spacing: 0.2px; font-weight: 800; }
    .subtitle { margin: 6px 0 0; font-size: 14px; opacity: 0.9; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 18px; margin-top: 22px; }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 20px;
      border: 1px solid rgba(0,0,0,0.05);
    }
    .card.full { grid-column: 1 / -1; }
    .section-title { display: flex; align-items: center; gap: 10px; margin: 0 0 12px; font-size: 16px; font-weight: 700; color: var(--vinho); }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 600;
      background: rgba(169,123,110,.12);
      color: var(--terracota);
      margin-right: 6px;
      margin-bottom: 6px;
      font-size: 12px;
    }
    .pill.verde { background: rgba(85,117,112,.15); color: var(--verde); }
    .pill.azul { background: rgba(50,93,136,.12); color: var(--azul); }
    .pill.vinho { background: rgba(114,47,55,.12); color: var(--vinho); }
    code {
      background: var(--code-bg);
      color: #e9edf5;
      padding: 12px 14px;
      border-radius: 12px;
      display: block;
      white-space: pre-wrap;
      font-size: 11px;
      line-height: 1.5;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
      margin: 10px 0;
    }
    code.inline {
      display: inline;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 11px;
    }
    ul { margin: 6px 0 0 20px; padding: 0; }
    li { margin-bottom: 6px; font-size: 13px; }
    .icon { width: 18px; height: 18px; vertical-align: middle; filter: drop-shadow(0 2px 4px rgba(0,0,0,.15)); }
    .callout {
      border-radius: 12px;
      padding: 12px 14px;
      margin-top: 10px;
      background: linear-gradient(135deg, rgba(114,47,55,.08), rgba(50,93,136,.08));
      border: 1px solid rgba(0,0,0,0.05);
      font-size: 13px;
    }
    .callout.success { background: linear-gradient(135deg, rgba(85,117,112,.12), rgba(85,117,112,.08)); }
    .callout.warning { background: linear-gradient(135deg, rgba(182,106,61,.15), rgba(169,123,110,.10)); }
    .screenshot-placeholder {
      background: linear-gradient(135deg, #ddd, #eee);
      border: 2px dashed #999;
      border-radius: 12px;
      padding: 40px 20px;
      text-align: center;
      color: #666;
      font-style: italic;
      margin: 10px 0;
    }
    .flow-arrow { color: var(--azul); font-weight: bold; margin: 0 8px; }
    h3 { color: var(--azul); font-size: 14px; margin: 14px 0 8px; }
    p { font-size: 13px; line-height: 1.6; margin: 8px 0; }
    .version { font-size: 11px; color: #888; margin-top: 20px; text-align: center; }
  </style>
</head>

  <svg style="display:none" aria-hidden="true" focusable="false">
  <symbol id="fa-user-pen" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M48.1 546.3C48.1 447.8 127.9 368 226.4 368L285.8 368C321.7 368 355.2 378.6 383.2 396.9L315.9 464.2C300.3 479.8 289.6 499.7 285.3 521.4L274.3 576L77.8 576C61.4 576 48.1 562.7 48.1 546.3zM376.1 192C376.1 258.3 322.4 312 256.1 312C189.8 312 136.1 258.3 136.1 192C136.1 125.7 189.8 72 256.1 72C322.4 72 376.1 125.7 376.1 192z"/><path fill="currentColor" d="M320.4 590.5L332.3 530.9C334.8 518.5 340.9 507.1 349.8 498.2L468.7 379.3L548.7 459.3L429.8 578.2C420.9 587.1 409.5 593.2 397.1 595.7L337.5 607.6C336.6 607.8 335.6 607.9 334.6 607.9C326.6 607.9 320 601.4 320 593.3C320 592.3 320.1 591.4 320.3 590.4zM571.4 436.7L491.4 356.7L520.2 327.9C542.3 305.8 578.1 305.8 600.2 327.9C622.3 350 622.3 385.8 600.2 407.9L571.4 436.7z"/></symbol>
  <symbol id="fa-circle-info" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M64 320C64 461.4 178.6 576 320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320zM256 312C256 298.7 266.7 288 280 288L328 288C341.3 288 352 298.7 352 312L352 400L360 400C373.3 400 384 410.7 384 424C384 437.3 373.3 448 360 448L280 448C266.7 448 256 437.3 256 424C256 410.7 266.7 400 280 400L304 400L304 336L280 336C266.7 336 256 325.3 256 312zM352 224C352 241.7 337.7 256 320 256C302.3 256 288 241.7 288 224C288 206.3 302.3 192 320 192C337.7 192 352 206.3 352 224z"/><path fill="currentColor" d="M320 192C337.7 192 352 206.3 352 224C352 241.7 337.7 256 320 256C302.3 256 288 241.7 288 224C288 206.3 302.3 192 320 192zM256 312C256 298.7 266.7 288 280 288L328 288C341.3 288 352 298.7 352 312L352 400L360 400C373.3 400 384 410.7 384 424C384 437.3 373.3 448 360 448L280 448C266.7 448 256 437.3 256 424C256 410.7 266.7 400 280 400L304 400L304 336L280 336C266.7 336 256 325.3 256 312z"/></symbol>
  <symbol id="fa-check" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M530.8 134.1C545.1 144.5 548.3 164.5 537.9 178.8L281.9 530.8C276.4 538.4 267.9 543.1 258.5 543.9C249.1 544.7 240 541.2 233.4 534.6L105.4 406.6C92.9 394.1 92.9 373.8 105.4 361.3C117.9 348.8 138.2 348.8 150.7 361.3L252.2 462.8L486.2 141.1C496.6 126.8 516.6 123.6 530.9 134z"/><path fill="currentColor" d=""/></symbol>
  <symbol id="fa-pen" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M355 147C401 193 447 239 492.9 284.9C513.5 264.3 534.1 243.7 554.8 223C568.4 209.4 576 191.1 576 171.9C576 152.7 568.4 134.3 554.8 120.8L519.1 85.2C505.6 71.6 487.2 64 468 64C448.8 64 430.4 71.6 416.9 85.2C396.3 105.8 375.6 126.4 355 147z"/><path fill="currentColor" d="M122.9 379.1C112.2 389.8 104.4 403.2 100.3 417.8L64.9 545.6C62.6 553.9 64.9 562.9 71.1 569C77.3 575.1 86.2 577.5 94.5 575.2L222.3 539.7C236.9 535.6 250.2 527.9 261 517.1L493 285L355 147L122.9 379.1z"/></symbol>
  <symbol id="fa-camera" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M224 352C224 405 267 448 320 448C373 448 416 405 416 352C416 299 373 256 320 256C267 256 224 299 224 352z"/><path fill="currentColor" d="M213.1 128.8L202.7 160L128 160C92.7 160 64 188.7 64 224L64 480C64 515.3 92.7 544 128 544L512 544C547.3 544 576 515.3 576 480L576 224C576 188.7 547.3 160 512 160L437.3 160L426.9 128.8C420.4 109.2 402.1 96 381.4 96L258.6 96C237.9 96 219.6 109.2 213.1 128.8zM320 256C373 256 416 299 416 352C416 405 373 448 320 448C267 448 224 405 224 352C224 299 267 256 320 256z"/></symbol>
  <symbol id="fa-shield-check" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M80 204C80.5 303.2 121.3 484.7 293.6 567.2C310.3 575.2 329.7 575.2 346.3 567.2C518.7 484.7 559.5 303.3 560 204C560.1 177.8 543.7 156.1 521.7 146.8L333.4 66.9C329.3 65 324.7 64 320.1 64C315.5 64 310.9 65 306.7 66.9L118.3 146.8C96.3 156.1 79.9 177.8 80 204zM230.8 357.5C221.6 348 221.8 332.8 231.4 323.6C240.9 314.4 256.1 314.6 265.3 324.2C274.1 333.3 283 342.5 291.8 351.6C320.3 312.4 348.9 273.1 377.4 233.9C385.2 223.2 400.2 220.8 410.9 228.6C421.6 236.4 424 251.4 416.2 262.1C382.1 309 347.9 356 313.8 402.9C309.6 408.6 303.1 412.3 296 412.7C288.9 413.1 282 410.5 277.1 405.4C261.6 389.4 246.2 373.4 230.7 357.4z"/><path fill="currentColor" d="M377.4 233.9C385.2 223.2 400.2 220.8 410.9 228.6C421.6 236.4 424 251.4 416.2 262.1L313.8 402.9C309.6 408.6 303.1 412.3 296 412.7C288.9 413.1 282 410.5 277.1 405.4L230.7 357.4C221.5 347.9 221.7 332.7 231.3 323.5C240.9 314.3 256 314.6 265.2 324.1L291.7 351.5L377.3 233.8z"/></symbol>
  <symbol id="fa-lightbulb" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M128 256C128 307.2 148 353.7 180.7 388.1C204.3 413 224 443.4 224 477.7L224 480L416 480L416 477.7C416 443.4 435.7 413 459.3 388.1C492 353.7 512 307.2 512 256C512 150 426 64 320 64C214 64 128 150 128 256zM192 248C192 181.7 245.7 128 312 128C325.3 128 336 138.7 336 152C336 165.3 325.3 176 312 176C272.2 176 240 208.2 240 248C240 261.3 229.3 272 216 272C202.7 272 192 261.3 192 248z"/><path fill="currentColor" d="M224 480L416 480L416 512C416 556.2 380.2 592 336 592L304 592C259.8 592 224 556.2 224 512L224 480z"/></symbol>
  <symbol id="fa-sitemap" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M104 376L104 416L152 416L152 376C152 353.9 169.9 336 192 336L296 336L296 416L344 416L344 336L448 336C470.1 336 488 353.9 488 376L488 416L536 416L536 376C536 327.4 496.6 288 448 288L344 288L344 224L296 224L296 288L192 288C143.4 288 104 327.4 104 376z"/><path fill="currentColor" d="M256 128C256 110.3 270.3 96 288 96L352 96C369.7 96 384 110.3 384 128L384 192C384 209.7 369.7 224 352 224L288 224C270.3 224 256 209.7 256 192L256 128zM96 416L160 416C177.7 416 192 430.3 192 448L192 512C192 529.7 177.7 544 160 544L96 544C78.3 544 64 529.7 64 512L64 448C64 430.3 78.3 416 96 416zM288 416L352 416C369.7 416 384 430.3 384 448L384 512C384 529.7 369.7 544 352 544L288 544C270.3 544 256 529.7 256 512L256 448C256 430.3 270.3 416 288 416zM480 416L544 416C561.7 416 576 430.3 576 448L576 512C576 529.7 561.7 544 544 544L480 544C462.3 544 448 529.7 448 512L448 448C448 430.3 462.3 416 480 416z"/></symbol>
  <symbol id="fa-id-card" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M32 192L32 480C32 515.3 60.7 544 96 544L544 544C579.3 544 608 515.3 608 480L608 192L32 192zM114.3 445C129 427.3 151.2 416 176 416L240 416C264.8 416 287 427.3 301.7 445C314.6 460.6 299.5 480 279.3 480L136.8 480C116.6 480 101.5 460.6 114.4 445zM264 320C264 350.9 238.9 376 208 376C177.1 376 152 350.9 152 320C152 289.1 177.1 264 208 264C238.9 264 264 289.1 264 320zM368 296C368 282.7 378.7 272 392 272L504 272C517.3 272 528 282.7 528 296C528 309.3 517.3 320 504 320L392 320C378.7 320 368 309.3 368 296zM368 392C368 378.7 378.7 368 392 368L504 368C517.3 368 528 378.7 528 392C528 405.3 517.3 416 504 416L392 416C378.7 416 368 405.3 368 392z"/><path fill="currentColor" d="M96 96C60.7 96 32 124.7 32 160L32 192L608 192L608 160C608 124.7 579.3 96 544 96L96 96zM264 320C264 289.1 238.9 264 208 264C177.1 264 152 289.1 152 320C152 350.9 177.1 376 208 376C238.9 376 264 350.9 264 320zM279.3 480C299.5 480 314.6 460.6 301.7 445C287 427.3 264.8 416 240 416L176 416C151.2 416 129 427.3 114.3 445C101.4 460.6 116.5 480 136.7 480L279.2 480z"/></symbol>
  <symbol id="fa-triangle-exclamation" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M68.8 485C62.1 497.4 62.4 512.4 69.6 524.5C76.8 536.6 89.9 544 104 544L536 544C550.1 544 563.1 536.6 570.4 524.5C577.7 512.4 577.9 497.4 571.2 485L355.2 85C348.2 72.1 334.7 64 320 64C305.3 64 291.8 72.1 284.8 85L68.8 485zM352 448C352 465.7 337.7 480 320 480C302.3 480 288 465.7 288 448C288 430.3 302.3 416 320 416C337.7 416 352 430.3 352 448zM288.6 257.7C287.3 239.5 301.7 224 320 224C338.3 224 352.7 239.5 351.4 257.7L344 361.7C343 374.3 332.6 384 320 384C307.4 384 297 374.3 296.1 361.7L288.7 257.7z"/><path fill="currentColor" d="M320 480C302.3 480 288 465.7 288 448C288 430.3 302.3 416 320 416C337.7 416 352 430.3 352 448C352 465.7 337.7 480 320 480zM320 224C338.3 224 352.7 239.5 351.4 257.7L344 361.7C343 374.3 332.6 384 320 384C307.4 384 297 374.3 296.1 361.7L288.7 257.7C287.3 239.5 301.7 224 320 224z"/></symbol>
  <symbol id="fa-list-check" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M224 480C224 462.3 238.3 448 256 448L544 448C561.7 448 576 462.3 576 480C576 497.7 561.7 512 544 512L256 512C238.3 512 224 497.7 224 480zM288 160C288 142.3 302.3 128 320 128L544 128C561.7 128 576 142.3 576 160C576 177.7 561.7 192 544 192L320 192C302.3 192 288 177.7 288 160zM288 320C288 302.3 302.3 288 320 288L544 288C561.7 288 576 302.3 576 320C576 337.7 561.7 352 544 352L320 352C302.3 352 288 337.7 288 320z"/><path fill="currentColor" d="M203.7 133.8C211.3 122.9 208.7 108 197.8 100.4C186.9 92.8 172 95.4 164.4 106.3L124.7 162.8L105 143C95.6 133.7 80.4 133.7 71 143C61.6 152.3 61.7 167.6 71 177L111 217C116 222 123 224.6 130.1 223.9C137.2 223.2 143.6 219.6 147.7 213.8L203.7 133.8zM203.7 293.8C211.3 282.9 208.7 268 197.8 260.4C186.9 252.8 172 255.4 164.4 266.3L124.7 322.8L105 303C95.6 293.6 80.4 293.6 71.1 303C61.8 312.4 61.7 327.6 71 337L111 377C116 382 123 384.6 130.1 383.9C137.2 383.2 143.6 379.6 147.7 373.8L203.7 293.8zM128 520C150.1 520 168 502.1 168 480C168 457.9 150.1 440 128 440C105.9 440 88 457.9 88 480C88 502.1 105.9 520 128 520z"/></symbol>
  <symbol id="fa-wrench" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M256 224C256 241.5 258.8 258.4 264 274.2C279.8 322.2 317.8 360.2 365.8 376C381.6 381.2 398.4 384 416 384C504.4 384 576 312.4 576 224C576 203.9 572.3 184.6 565.5 166.9C561.7 156.9 549 155.1 541.4 162.6L452.7 251.3C449.7 254.3 445.6 256 441.4 256L400 256C391.2 256 384 248.8 384 240L384 198.6C384 194.4 385.7 190.3 388.7 187.3L477.4 98.6C485 91 483.1 78.3 473.1 74.5C455.4 67.7 436.1 64 416 64C327.6 64 256 135.6 256 224z"/><path fill="currentColor" d="M264 274.2C279.8 322.2 317.8 360.2 365.8 376L178.9 562.9C150.8 591 105.2 591 77.1 562.9C49 534.8 49 489.2 77.1 461.1L264 274.2z"/></symbol>
  <symbol id="fa-plus" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M352 128C352 110.3 337.7 96 320 96C302.3 96 288 110.3 288 128L288 288L128 288C110.3 288 96 302.3 96 320C96 337.7 110.3 352 128 352L288 352L288 512C288 529.7 302.3 544 320 544C337.7 544 352 529.7 352 512L352 352L512 352C529.7 352 544 337.7 544 320C544 302.3 529.7 288 512 288L352 288L352 128z"/><path fill="currentColor" d=""/></symbol>
  <symbol id="fa-pen-to-square" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M64 224C64 171 107 128 160 128L256 128C273.7 128 288 142.3 288 160C288 177.7 273.7 192 256 192L160 192C142.3 192 128 206.3 128 224L128 480C128 497.7 142.3 512 160 512L416 512C433.7 512 448 497.7 448 480L448 384C448 366.3 462.3 352 480 352C497.7 352 512 366.3 512 384L512 480C512 533 469 576 416 576L160 576C107 576 64 533 64 480L64 224z"/><path fill="currentColor" d="M456.4 85.7L432 110.1L529.9 208L554.3 183.6C576.2 161.7 576.2 126.3 554.3 104.4L535.6 85.7C513.7 63.8 478.3 63.8 456.4 85.7zM398.1 144L236.4 305.7C230.3 311.8 225.6 319.3 222.9 327.6L193.3 416.4C190.4 425 192.7 434.5 199.1 441C205.5 447.5 215 449.7 223.7 446.8L312.5 417.2C320.7 414.5 328.2 409.8 334.4 403.7L496 241.9L398.1 144z"/></symbol>
  <symbol id="fa-image" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160C544 124.7 515.3 96 480 96L160 96C124.7 96 96 124.7 96 160zM162.7 467.1C158.6 459.2 159.2 449.6 164.3 442.3L220.3 362.3C224.8 355.9 232.1 352.1 240 352.1C247.9 352.1 255.2 355.9 259.7 362.3L286.1 400.1L347.5 299.6C351.9 292.5 359.6 288.1 368 288.1C376.4 288.1 384.1 292.5 388.5 299.6L476.5 443.6C481 451 481.2 460.3 477 467.9C472.8 475.5 464.7 480 456 480L184 480C175.1 480 166.8 475 162.7 467.1zM272 224C272 250.5 250.5 272 224 272C197.5 272 176 250.5 176 224C176 197.5 197.5 176 224 176C250.5 176 272 197.5 272 224z"/><path fill="currentColor" d="M388.5 299.5C384.1 292.4 376.4 288 368 288C359.6 288 351.9 292.4 347.5 299.5L286.1 400L259.7 362.2C255.2 355.8 247.9 352 240 352C232.1 352 224.8 355.8 220.3 362.2L164.3 442.2C159.2 449.5 158.5 459.1 162.7 467C166.9 474.9 175.1 480 184 480L456 480C464.7 480 472.7 475.3 476.9 467.7C481.1 460.1 481 450.9 476.4 443.4L388.4 299.4z"/></symbol>
  <symbol id="fa-image-user" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160C544 124.7 515.3 96 480 96L160 96C124.7 96 96 124.7 96 160zM208 432C208 387.8 243.8 352 288 352L352 352C396.2 352 432 387.8 432 432C432 440.8 424.8 448 416 448L224 448C215.2 448 208 440.8 208 432zM376 256C376 286.9 350.9 312 320 312C289.1 312 264 286.9 264 256C264 225.1 289.1 200 320 200C350.9 200 376 225.1 376 256z"/><path fill="currentColor" d="M320 312C350.9 312 376 286.9 376 256C376 225.1 350.9 200 320 200C289.1 200 264 225.1 264 256C264 286.9 289.1 312 320 312zM288 352C243.8 352 208 387.8 208 432C208 440.8 215.2 448 224 448L416 448C424.8 448 432 440.8 432 432C432 387.8 396.2 352 352 352L288 352z"/></symbol>
  <symbol id="fa-eye-slash" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M34.5 307.7C31.2 315.6 31.2 324.4 34.5 332.3C49.4 368 80.7 420 127.5 463.4C174.6 507.1 239.3 544 320.1 544C357.4 544 391.3 536.1 421.6 523.4L357.4 459.2C345.5 462.4 333 464.1 320.1 464.1C240.6 464.1 176.1 399.6 176.1 320.1C176.1 307.2 177.8 294.7 181 282.8L101.4 203.2C68.9 240 46.4 279.1 34.5 307.7z"/><path fill="currentColor" d="M73 39.1C63.6 29.7 48.4 29.7 39.1 39.1C29.8 48.5 29.7 63.7 39 73.1L567 601.1C576.4 610.5 591.6 610.5 600.9 601.1C610.2 591.7 610.3 576.5 600.9 567.2L504.5 470.8C507.2 468.4 509.9 466 512.5 463.6C559.3 420.1 590.6 368.2 605.5 332.5C608.8 324.6 608.8 315.8 605.5 307.9C590.6 272.2 559.3 220.2 512.5 176.8C465.4 133.1 400.7 96.2 319.9 96.2C263.1 96.2 214.3 114.4 173.9 140.4L73 39.1zM236.5 202.7C260 185.9 288.9 176 320 176C399.5 176 464 240.5 464 320C464 351.1 454.1 379.9 437.3 403.5L402.6 368.8C411.1 354.5 415.9 337.8 415.9 320C415.9 267 372.9 224 319.9 224C302.1 224 285.4 228.9 271.1 237.3L236.4 202.6z"/></symbol>
  <symbol id="fa-code" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M225.2 535.2C220.3 552.2 230.2 569.9 247.2 574.8C264.2 579.7 281.9 569.8 286.8 552.8L414.8 104.8C419.7 87.8 409.8 70.1 392.8 65.2C375.8 60.3 358.1 70.2 353.2 87.2L225.2 535.2z"/><path fill="currentColor" d="M457.4 201.4C444.9 213.9 444.9 234.2 457.4 246.7L530.8 320.1L457.4 393.5C444.9 406 444.9 426.3 457.4 438.8C469.9 451.3 490.2 451.3 502.7 438.8L598.7 342.8C611.2 330.3 611.2 310 598.7 297.5L502.7 201.5C490.2 189 469.9 189 457.4 201.5zM182.7 201.4C170.2 188.9 149.9 188.9 137.4 201.4L41.4 297.4C28.9 309.9 28.9 330.2 41.4 342.7L137.4 438.7C149.9 451.2 170.2 451.2 182.7 438.7C195.2 426.2 195.2 405.9 182.7 393.4L109.3 320L182.6 246.6C195.1 234.1 195.1 213.8 182.6 201.3z"/></symbol>
  <symbol id="fa-arrow-down-a-z" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M339.4 273.7C331.5 289.5 337.9 308.7 353.7 316.6C369.5 324.5 388.7 318.1 396.6 302.3L403.8 288L492.2 288L499.4 302.3C507.3 318.1 526.5 324.5 542.3 316.6C558.1 308.7 564.5 289.5 556.6 273.7C553.9 268.4 527.3 215 476.6 113.7C471.2 102.9 460.1 96 448 96C435.9 96 424.8 102.8 419.4 113.7C368.7 215 342.1 268.4 339.4 273.7zM352 384C352 401.7 366.3 416 384 416L434.7 416L361.3 489.4C352.1 498.6 349.4 512.3 354.4 524.3C359.4 536.3 371.1 544 384 544L512 544C529.7 544 544 529.7 544 512C544 494.3 529.7 480 512 480L461.3 480L534.7 406.6C543.9 397.4 546.6 383.7 541.6 371.7C536.6 359.7 524.9 352 512 352L384 352C366.3 352 352 366.3 352 384zM427.8 240L448 199.6L468.2 240L427.8 240z"/><path fill="currentColor" d="M169.4 534.6C181.9 547.1 202.2 547.1 214.7 534.6L294.7 454.6C307.2 442.1 307.2 421.8 294.7 409.3C282.2 396.8 261.9 396.8 249.4 409.3L224 434.7L224 128C224 110.3 209.7 96 192 96C174.3 96 160 110.3 160 128L160 434.7L134.6 409.3C122.1 396.8 101.8 396.8 89.3 409.3C76.8 421.8 76.8 442.1 89.3 454.6L169.3 534.6z"/></symbol>
  <symbol id="fa-circle-check" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M64 320C64 461.4 178.6 576 320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320zM199.1 327.1C208.5 317.7 223.7 317.7 233 327.1L285.1 379.2L404.5 215C412.3 204.3 427.3 201.9 438 209.7C448.7 217.5 451.1 232.5 443.3 243.2L307.4 430.1C303.3 435.8 296.9 439.4 289.9 439.9C282.9 440.4 276 437.9 271.1 432.9L199.1 360.9C189.7 351.5 189.7 336.3 199.1 327z"/><path fill="currentColor" d="M404.5 215C412.3 204.3 427.3 201.9 438 209.7C448.7 217.5 451.1 232.5 443.3 243.2L307.4 430.1C303.3 435.8 296.9 439.4 289.9 439.9C282.9 440.4 276 437.9 271.1 432.9L199.1 360.9C189.7 351.5 189.7 336.3 199.1 327C208.5 317.7 223.7 317.6 233 327L285.1 379.2L404.5 215z"/></symbol>
  <symbol id="fa-sparkles" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M384 512C384 516.8 387 521.1 391.5 522.8L448 544L469.2 600.5C470.9 605 475.2 608 480 608C484.8 608 489.1 605 490.8 600.5L512 544L568.5 522.8C573 521.1 576 516.8 576 512C576 507.2 573 502.9 568.5 501.2L512 480L490.8 423.5C489.1 419 484.8 416 480 416C475.2 416 470.9 419 469.2 423.5L448 480L391.5 501.2C387 502.9 384 507.2 384 512zM416 128C416 132.8 419 137.1 423.5 138.8L480 160L501.2 216.5C502.9 221 507.2 224 512 224C516.8 224 521.1 221 522.8 216.5L544 160L600.5 138.8C605 137.1 608 132.8 608 128C608 123.2 605 118.9 600.5 117.2L544 96L522.8 39.5C521.1 35 516.8 32 512 32C507.2 32 502.9 35 501.2 39.5L480 96L423.5 117.2C419 118.9 416 123.2 416 128z"/><path fill="currentColor" d="M237.1 137.3C234.5 131.6 228.8 128 222.6 128C216.4 128 210.7 131.6 208.1 137.3L155.4 251.4L41.3 304C35.6 306.6 32 312.3 32 318.6C32 324.9 35.6 330.5 41.3 333.1L155.4 385.8L208 499.8C210.6 505.5 216.3 509.1 222.5 509.1C228.7 509.1 234.4 505.5 237 499.8L289.7 385.7L403.8 333C409.5 330.4 413.1 324.7 413.1 318.5C413.1 312.3 409.5 306.6 403.8 304L289.8 251.4L237.1 137.3z"/></symbol>
  <symbol id="fa-diagram-project" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M192 288L208 288C227.2 288 243.7 276.8 251.4 260.5L320 352L304 352C284.8 352 268.3 363.2 260.6 379.5L192 288zM256 160L384 160L384 224L256 224L256 160z"/><path fill="currentColor" d="M64 144C64 117.5 85.5 96 112 96L208 96C234.5 96 256 117.5 256 144L256 240C256 266.5 234.5 288 208 288L112 288C85.5 288 64 266.5 64 240L64 144zM256 400C256 373.5 277.5 352 304 352L400 352C426.5 352 448 373.5 448 400L448 496C448 522.5 426.5 544 400 544L304 544C277.5 544 256 522.5 256 496L256 400zM432 96L528 96C554.5 96 576 117.5 576 144L576 240C576 266.5 554.5 288 528 288L432 288C405.5 288 384 266.5 384 240L384 144C384 117.5 405.5 96 432 96z"/></symbol>
  <symbol id="fa-file-lines" viewBox="0 0 640 640"><!--! Font Awesome Pro 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc. --><path opacity=".4" fill="currentColor" d="M128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 234.5C512 217.5 505.3 201.2 493.3 189.2L386.7 82.7C374.7 70.7 358.5 64 341.5 64L192 64C156.7 64 128 92.7 128 128zM224 344C224 330.7 234.7 320 248 320L392 320C405.3 320 416 330.7 416 344C416 357.3 405.3 368 392 368L248 368C234.7 368 224 357.3 224 344zM224 440C224 426.7 234.7 416 248 416L392 416C405.3 416 416 426.7 416 440C416 453.3 405.3 464 392 464L248 464C234.7 464 224 453.3 224 440zM336 122.5L453.5 240L360 240C346.7 240 336 229.3 336 216L336 122.5z"/><path fill="currentColor" d="M224 344C224 330.7 234.7 320 248 320L392 320C405.3 320 416 330.7 416 344C416 357.3 405.3 368 392 368L248 368C234.7 368 224 357.3 224 344zM224 440C224 426.7 234.7 416 248 416L392 416C405.3 416 416 426.7 416 440C416 453.3 405.3 464 392 464L248 464C234.7 464 224 453.3 224 440z"/></symbol>
</svg>
  <header class="hero">
    <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-user-pen"></use></svg>
    <div>
      <h1>Usuarios - Upsert</h1>
      <p class="subtitle">Cadastro e Edição de Usuários do Sistema FrotiX</p>
    </div>
  </header>

  <main class="grid">
    <!-- Visão Geral -->
    <section class="card">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-circle-info"></use></svg>
        Visão Geral
      </div>
      <p>A página <strong>Usuarios/Upsert</strong> é o coração do cadastro de usuários do FrotiX. Aqui, cada pessoa que precisará acessar o sistema ganha sua identidade digital — desde o ponto funcional até a foto que aparecerá em todo o sistema.</p>

      <div style="margin-top: 12px;">
        <span class="pill verde"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-check"></use></svg> Criação</span>
        <span class="pill verde"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-pen"></use></svg> Edição</span>
        <span class="pill azul"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-camera"></use></svg> Upload Foto</span>
        <span class="pill azul"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-shield-check"></use></svg> Validações</span>
      </div>

      <div class="callout">
        <strong><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-lightbulb"></use></svg> Importante:</strong> O sistema usa ASP.NET Core Identity para autenticação, mas com propriedades customizadas na classe <code class="inline">AspNetUsers</code> que estendem o <code class="inline">IdentityUser</code> padrão.
      </div>
    </section>

    <!-- Arquitetura -->
    <section class="card">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-sitemap"></use></svg>
        Arquitetura
      </div>
      <p>Esta página segue o padrão <strong>Razor Pages</strong>, onde a view (.cshtml) e a lógica (.cshtml.cs) trabalham em harmonia:</p>

      <div style="font-family: monospace; font-size: 11px; background: #f5f7fb; padding: 10px; border-radius: 8px; margin: 10px 0;">
        Pages/Usuarios/<br/>
        ├── <strong>Upsert.cshtml</strong> (View + JavaScript)<br/>
        └── <strong>Upsert.cshtml.cs</strong> (PageModel)
      </div>

      <p>O fluxo é elegante: <span class="pill azul">OnGet</span> <span class="flow-arrow">→</span> carrega dados <span class="flow-arrow">→</span> <span class="pill verde">OnPostSubmit</span> ou <span class="pill terracota">OnPostEdit</span></p>
    </section>

    <!-- Campos Identity -->
    <section class="card full">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-id-card"></use></svg>
        Campos Obrigatórios do Identity
      </div>
      <p>Uma das lições aprendidas neste módulo: o ASP.NET Core Identity possui campos que <em>precisam</em> estar preenchidos para que o usuário funcione corretamente no sistema. Quando usamos <code class="inline">UserManager&lt;IdentityUser&gt;</code> (genérico), as propriedades customizadas não são salvas automaticamente.</p>

      <div class="callout warning">
        <strong><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-triangle-exclamation"></use></svg> Problema Descoberto:</strong> Usuários criados com campos NULL causavam: avatar não exibido na lista, registros fora de ordem alfabética, status "Inativo" mesmo sendo criados como "Ativo".
      </div>

      <h3><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-list-check"></use></svg> Campos que devem ser preenchidos:</h3>
      <ul>
        <li><code class="inline">NormalizedUserName</code> — UserName em MAIÚSCULAS (usado para ordenação)</li>
        <li><code class="inline">NormalizedEmail</code> — Email em MAIÚSCULAS</li>
        <li><code class="inline">PasswordHash</code> — Hash da senha (nunca a senha em texto!)</li>
        <li><code class="inline">SecurityStamp</code> — GUID único para invalidar tokens</li>
        <li><code class="inline">ConcurrencyStamp</code> — GUID para controle de concorrência</li>
        <li><code class="inline">Status</code> — Deve ser <strong>true</strong> para novos usuários</li>
        <li><code class="inline">UsuarioIdAlteracao</code> — ID de quem criou/alterou</li>
      </ul>
    </section>

    <!-- Solução Implementada -->
    <section class="card full">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-wrench"></use></svg>
        Solução Implementada
      </div>

      <h3><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-plus"></use></svg> OnPostSubmit (Criação)</h3>
      <p>Para novos usuários, todos os campos são preenchidos manualmente, bypassing o UserManager:</p>
      <code>// Status SEMPRE true para novos usuários
// Não usar ?? porque false ?? true = false!
bool statusUsuario = true;

var novoUsuario = new AspNetUsers
{
    Id = Guid.NewGuid().ToString(),
    UserName = UsuarioObj.AspNetUsers.UserName,
    NormalizedUserName = UsuarioObj.AspNetUsers.UserName?.ToUpper(),
    NormalizedEmail = UsuarioObj.AspNetUsers.Email?.ToUpper(),
    SecurityStamp = Guid.NewGuid().ToString(),
    ConcurrencyStamp = Guid.NewGuid().ToString(),
    Status = statusUsuario,
    UsuarioIdAlteracao = User.FindFirst(ClaimTypes.NameIdentifier)?.Value
};

// Gera hash usando o PasswordHasher do Identity
novoUsuario.PasswordHash = _userManager.PasswordHasher.HashPassword(null, "visual");

_unitOfWork.AspNetUsers.Add(novoUsuario);
_unitOfWork.Save();</code>

      <h3><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-pen-to-square"></use></svg> OnPostEdit (Edição)</h3>
      <p>Na edição, garantimos que os campos obrigatórios sejam preenchidos e preservamos os dados sensíveis:</p>
      <code>// Preencher campos obrigatórios
UsuarioObj.AspNetUsers.NormalizedUserName = UsuarioObj.AspNetUsers.UserName?.ToUpper();
UsuarioObj.AspNetUsers.NormalizedEmail = UsuarioObj.AspNetUsers.Email?.ToUpper();
UsuarioObj.AspNetUsers.UsuarioIdAlteracao = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;

// Preservar campos que não devem ser alterados
if (usuarioExistente != null)
{
    UsuarioObj.AspNetUsers.PasswordHash = usuarioExistente.PasswordHash;
    UsuarioObj.AspNetUsers.SecurityStamp = usuarioExistente.SecurityStamp;
    UsuarioObj.AspNetUsers.ConcurrencyStamp = usuarioExistente.ConcurrencyStamp;
    UsuarioObj.AspNetUsers.Criacao = usuarioExistente.Criacao;
}</code>
    </section>

    <!-- Screenshot Placeholder -->
    <section class="card full">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-image"></use></svg>
        Tela do Sistema
      </div>
      <div class="screenshot-placeholder">
        [SCREENSHOT: Página de Cadastro de Usuário (Upsert) com formulário preenchido, mostrando campos: Ponto, Nome Completo, Email, Celular, Ramal, Status, Detentor de Carga Patrimonial e área de upload de foto]
      </div>
    </section>

    <!-- Avatar e Ordenação -->
    <section class="card full">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-image-user"></use></svg>
        Avatar e Ordenação na Lista
      </div>
      <p>Outro desafio interessante: mesmo com a foto sendo salva corretamente, o avatar não aparecia na listagem. A investigação revelou um detalhe sutil do CSS:</p>

      <div class="callout warning">
        <strong><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-eye-slash"></use></svg> Descoberta:</strong> A classe <code class="inline">.ftx-avatar-img</code> é definida com <code class="inline">opacity: 0</code> e <code class="inline">visibility: hidden</code> por padrão. Só fica visível com a classe <code class="inline">is-visible</code>.
      </div>

      <h3><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-code"></use></svg> Correção no JavaScript</h3>
      <code>// Antes: imagem invisível
avatarHtml = `&lt;img class="ftx-avatar-img" ...`;

// Depois: container + classe is-visible
avatarHtml = `&lt;div class="ftx-avatar btnAbrirFoto" ...>
                &lt;img class="ftx-avatar-img is-visible" ... />
              &lt;/div>`;</code>

      <h3><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-arrow-down-a-z"></use></svg> Ordenação Correta</h3>
      <p>O DataTable também precisou de ajuste para ordenar pelo nome puro, não pelo HTML:</p>
      <code>render: function (data, type, row) {
    const nome = data || 'Sem Nome';

    // Para ordenação/filtro: texto puro
    if (type === 'sort' || type === 'filter') {
        return nome;
    }

    // Para exibição: HTML com avatar
    return `&lt;div>...${avatarHtml}...&lt;/div>`;
}</code>
    </section>

    <!-- Resultado -->
    <section class="card">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-circle-check"></use></svg>
        Resultado
      </div>
      <div class="callout success">
        <strong><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-sparkles"></use></svg> Após as correções:</strong>
        <ul style="margin-top: 8px;">
          <li>Avatar aparece corretamente na lista</li>
          <li>Usuários ordenados alfabeticamente</li>
          <li>Novos usuários com Status = Ativo</li>
          <li>Campos Identity sempre preenchidos</li>
          <li>Registro de quem criou/alterou</li>
        </ul>
      </div>
    </section>

    <!-- Interconexões -->
    <section class="card">
      <div class="section-title">
        <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-diagram-project"></use></svg>
        Interconexões
      </div>
      <p>Esta página se conecta com diversos componentes:</p>
      <ul>
        <li><strong>Model:</strong> <code class="inline">AspNetUsers</code> (herda de IdentityUser)</li>
        <li><strong>Repository:</strong> <code class="inline">_unitOfWork.AspNetUsers</code></li>
        <li><strong>Controller:</strong> <code class="inline">UsuarioController.Usuarios.cs</code> (GetAll, GetFoto)</li>
        <li><strong>JavaScript:</strong> <code class="inline">usuario-index.js</code> (DataTable na listagem)</li>
        <li><strong>Recursos:</strong> Cria <code class="inline">ControleAcesso</code> para novos usuários</li>
      </ul>
    </section>
  </main>

  <p class="version">
    <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-file-lines"></use></svg>
    Documentação FrotiX | Versão 1.6 | Atualizado em 11/01/2026
  </p>
</body>
</html>

