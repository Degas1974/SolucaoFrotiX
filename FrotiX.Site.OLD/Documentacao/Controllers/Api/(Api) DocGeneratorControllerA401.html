<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DocGeneratorController API | FrotiX - Documenta√ß√£o T√©cnica</title>

  <!-- FontAwesome Kit FrotiX -->
  <script src="https://kit.fontawesome.com/afeb78ad1f.js" crossorigin="anonymous"></script>

  <style>
    /* ==================== VARI√ÅVEIS CSS ==================== */
    :root {
      --color-header: #b66a3d;
      --color-vinho: #722F37;
      --color-azul: #325d88;
      --color-terracota: #A97B6E;
      --color-verde: #557570;
      --color-code-bg: #33465c;
      --color-code-text: #e8eaed;
      --color-card-bg: #ffffff;
      --color-border: #dee2e6;
      --color-text: #212529;
      --color-text-muted: #6c757d;
      --color-bg: #f0f0f0;
    }

    /* ==================== RESET E BASE ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 10pt;
      line-height: 1.5;
      color: var(--color-text);
      background: var(--color-bg);
      padding: 0;
      margin: 0;
    }

    /* ==================== LAYOUT A4 ==================== */
    .page {
      width: 210mm;
      min-height: 297mm;
      margin: 20px auto;
      background: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 15mm;
    }

    /* ==================== HEADER ==================== */
    .hero {
      background: linear-gradient(135deg, var(--color-header) 0%, #8a5030 100%);
      color: white;
      padding: 20px 24px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
      border: 2px solid #333;
      box-shadow:
        0 0 0 3px white,
        0 4px 12px rgba(0,0,0,0.2);
    }

    .hero i {
      font-size: 56px;
      color: white;
    }

    .hero h1 {
      font-size: 22pt;
      font-weight: 700;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .hero .subtitle {
      font-size: 11pt;
      margin: 4px 0 0 0;
      opacity: 0.95;
      font-weight: 400;
    }

    /* ==================== CARDS ==================== */
    .card {
      background: var(--color-card-bg);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .section-title {
      font-size: 13pt;
      font-weight: 700;
      color: var(--color-azul);
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--color-azul);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i.icon {
      font-size: 20px;
      color: var(--color-azul);
    }

    /* ==================== TIPOGRAFIA ==================== */
    h2 {
      font-size: 12pt;
      font-weight: 600;
      color: var(--color-vinho);
      margin: 12px 0 8px 0;
    }

    h3 {
      font-size: 11pt;
      font-weight: 600;
      color: var(--color-verde);
      margin: 10px 0 6px 0;
    }

    p {
      margin-bottom: 8px;
      text-align: justify;
    }

    ul, ol {
      margin-left: 20px;
      margin-bottom: 8px;
    }

    li {
      margin-bottom: 4px;
    }

    /* ==================== CODE SNIPPETS ==================== */
    code {
      background: var(--color-code-bg);
      color: var(--color-code-text);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Consolas', 'Courier New', monospace;
      font-size: 9pt;
    }

    pre {
      background: var(--color-code-bg);
      color: var(--color-code-text);
      padding: 12px;
      border-radius: 6px;
      overflow-x: auto;
      margin: 10px 0;
      border: 1px solid #1e2a38;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    pre code {
      background: none;
      padding: 0;
      font-size: 8.5pt;
    }

    /* ==================== TABELAS ==================== */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      font-size: 9pt;
    }

    table th {
      background: var(--color-azul);
      color: white;
      padding: 8px;
      text-align: left;
      font-weight: 600;
    }

    table td {
      padding: 6px 8px;
      border: 1px solid var(--color-border);
    }

    table tr:nth-child(even) {
      background: #f8f9fa;
    }

    /* ==================== BADGES ==================== */
    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 8.5pt;
      font-weight: 600;
      margin-right: 6px;
    }

    .badge-get { background: #28a745; color: white; }
    .badge-post { background: #007bff; color: white; }
    .badge-put { background: #ffc107; color: #333; }
    .badge-delete { background: #dc3545; color: white; }

    /* ==================== ALERTAS ==================== */
    .alert {
      padding: 10px 12px;
      border-radius: 6px;
      margin: 10px 0;
      border-left: 4px solid;
    }

    .alert-info {
      background: #d1ecf1;
      border-color: #0c5460;
      color: #0c5460;
    }

    .alert-warning {
      background: #fff3cd;
      border-color: #856404;
      color: #856404;
    }

    /* ==================== UTILIDADES ==================== */
    .text-muted {
      color: var(--color-text-muted);
      font-size: 9pt;
    }

    .mt-1 { margin-top: 8px; }
    .mb-1 { margin-bottom: 8px; }
    .mt-2 { margin-top: 16px; }
    .mb-2 { margin-bottom: 16px; }

    strong {
      color: var(--color-vinho);
    }

    .endpoint-card {
      background: #f8f9fa;
      border-left: 4px solid var(--color-azul);
      padding: 12px;
      margin: 10px 0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- HEADER -->
    <header class="hero">
      <i class="fa-duotone fa-file-code"></i>
      <div>
        <h1>DocGeneratorController API</h1>
        <p class="subtitle">Sistema de Gera√ß√£o Autom√°tica de Documenta√ß√£o T√©cnica</p>
      </div>
    </header>

    <!-- VIS√ÉO GERAL -->
    <section class="card">
      <div class="section-title">
        <i class="icon fa-duotone fa-circle-info"></i>
        Vis√£o Geral
      </div>
      <p>
        O <strong>DocGeneratorController</strong> √© o cora√ß√£o da automa√ß√£o de documenta√ß√£o do FrotiX. Imagine ter um assistente incans√°vel que percorre todo o seu projeto, identifica cada arquivo de c√≥digo, analisa sua estrutura e gera documenta√ß√£o completa automaticamente. √â exatamente isso que este controller faz.
      </p>
      <p>
        Localizado em <code>Controllers/Api/DocGeneratorController.cs</code>, esta API RESTful oferece endpoints para descobrir arquivos document√°veis, iniciar jobs de gera√ß√£o de documenta√ß√£o (com ou sem aux√≠lio de IA), monitorar progresso em tempo real, e gerenciar o cache de documenta√ß√£o. √â uma ferramenta essencial para manter a documenta√ß√£o do projeto sempre atualizada sem esfor√ßo manual.
      </p>

      <div class="alert alert-info mt-2">
        <strong>üí° Curiosidade:</strong> Este controller suporta m√∫ltiplos provedores de IA (OpenAI GPT-5.2, Claude 4.5, Gemini 3 Pro) para gerar documenta√ß√£o ainda mais inteligente e contextualizada, al√©m de um modo heur√≠stico que funciona sem IA.
      </div>
    </section>

    <!-- ARQUITETURA -->
    <section class="card">
      <div class="section-title">
        <i class="icon fa-duotone fa-sitemap"></i>
        Arquitetura e Depend√™ncias
      </div>

      <h2>Inje√ß√£o de Depend√™ncias</h2>
      <p>
        O controller utiliza <strong>Dependency Injection</strong> para receber quatro servi√ßos essenciais no construtor:
      </p>

      <table>
        <thead>
          <tr>
            <th>Servi√ßo</th>
            <th>Interface</th>
            <th>Responsabilidade</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Discovery Service</strong></td>
            <td><code>IFileDiscoveryService</code></td>
            <td>Descobre arquivos document√°veis no projeto</td>
          </tr>
          <tr>
            <td><strong>Orchestrator</strong></td>
            <td><code>IDocGeneratorOrchestrator</code></td>
            <td>Orquestra jobs de gera√ß√£o de documenta√ß√£o</td>
          </tr>
          <tr>
            <td><strong>Cache Service</strong></td>
            <td><code>IDocCacheService</code></td>
            <td>Gerencia cache de documenta√ß√£o gerada</td>
          </tr>
          <tr>
            <td><strong>Logger</strong></td>
            <td><code>ILogger</code></td>
            <td>Registra logs e eventos do sistema</td>
          </tr>
        </tbody>
      </table>

      <h2>Padr√£o de Tratamento de Erros</h2>
      <p>
        Seguindo o padr√£o FrotiX, <strong>todos os m√©todos</strong> s√£o envolvidos em blocos <code>try-catch</code> e utilizam <code>Alerta.TratamentoErroComLinha()</code> para tratamento consistente de exce√ß√µes:
      </p>

      <pre><code>catch (Exception error)
{
    Alerta.TratamentoErroComLinha("DocGeneratorController.cs", "NomeDoMetodo", error);
    return Json(new { success = false, message = error.Message });
}</code></pre>
    </section>

    <!-- ENDPOINTS - PARTE 1 -->
    <section class="card">
      <div class="section-title">
        <i class="icon fa-duotone fa-plug"></i>
        Endpoints da API
      </div>

      <div class="endpoint-card">
        <h3><span class="badge badge-get">GET</span> /api/DocGenerator/discover</h3>
        <p>
          <strong>Prop√≥sito:</strong> Descobre todos os arquivos document√°veis no projeto, analisando a estrutura de pastas e identificando quais arquivos j√° possuem documenta√ß√£o, quais precisam de atualiza√ß√£o e quais ainda n√£o foram documentados.
        </p>
        <p><strong>Par√¢metros:</strong> <code>CancellationToken</code> (opcional, para cancelamento)</p>
        <p><strong>Retorno (JSON):</strong></p>
        <pre><code>{
  "success": true,
  "data": {
    "totalFiles": 145,
    "filesWithDocs": 98,
    "filesNeedingUpdate": 12,
    "filesByCategory": { ... },
    "tree": { /* √°rvore de pastas */ }
  }
}</code></pre>
        <p class="text-muted mt-1">
          Este endpoint √© perfeito para exibir um dashboard mostrando o status geral da documenta√ß√£o do projeto.
        </p>
      </div>

      <div class="endpoint-card">
        <h3><span class="badge badge-get">GET</span> /api/DocGenerator/tree</h3>
        <p>
          <strong>Prop√≥sito:</strong> Retorna a √°rvore hier√°rquica de pastas e arquivos do projeto, √∫til para exibir em interfaces de sele√ß√£o de arquivos.
        </p>
        <p><strong>Retorno (JSON):</strong></p>
        <pre><code>{
  "success": true,
  "data": {
    "name": "FrotiX.Site",
    "children": [
      { "name": "Controllers", "children": [...] },
      { "name": "Pages", "children": [...] }
    ]
  }
}</code></pre>
      </div>

      <div class="endpoint-card">
        <h3><span class="badge badge-post">POST</span> /api/DocGenerator/generate</h3>
        <p>
          <strong>Prop√≥sito:</strong> Inicia um job de gera√ß√£o de documenta√ß√£o em background. Este √© o endpoint mais poderoso, permitindo configurar todos os aspectos da gera√ß√£o.
        </p>
        <p><strong>Request Body:</strong></p>
        <pre><code>{
  "onlyModified": false,
  "forceRegenerate": true,
  "useAi": true,
  "aiProvider": "claude",
  "aiModel": "claude-4.5-sonnet",
  "detailLevel": "exhaustive",
  "selectedPaths": [
    "Controllers/ViagemController.cs",
    "Pages/Viagens/Index.cshtml"
  ],
  "generateHtml": true,
  "generateMarkdown": true
}</code></pre>
      </div>
    </section>
  </div>
</body>
</html>
