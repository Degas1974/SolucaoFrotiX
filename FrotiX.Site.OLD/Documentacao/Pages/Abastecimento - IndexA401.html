<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Abastecimento - Index (Implementação) | FrotiX</title>
  <style>
    :root { --vinho:#722F37; --vinho-light:#8B3A44; --azul:#325d88; --azul-light:#3d6f9e; --terracota:#A97B6E; --terracota-light:#C08B7E; --verde:#557570; --verde-light:#6A8A85; --cinza:#f5f7fb; --card:#fff; --texto:#1f1f1f; --shadow:0 20px 45px -18px rgba(0,0,0,.35); --radius:14px; --header-bg:#b66a3d; --code-bg:#33465c; }
    @page { size: A4; margin: 16mm; }
    * { box-sizing: border-box; }
    body { margin:0; font-family:"Segoe UI","Inter",system-ui,-apple-system,sans-serif; background: radial-gradient(circle at 12% 20%, rgba(50,93,136,.08), transparent 26%), radial-gradient(circle at 90% 10%, rgba(114,47,55,.10), transparent 30%), var(--cinza); color:var(--texto); padding:22px; display:flex; justify-content:center; }
    .page { width:210mm; max-width:100%; }
    .hero { background:var(--header-bg); color:#fff; padding:22px 24px; border-radius:var(--radius); box-shadow:0 0 0 1px #000, 0 0 0 4px #fff, var(--shadow); display:flex; align-items:center; gap:16px; }
    .hero img { width:50px; height:50px; filter:drop-shadow(0 6px 8px rgba(0,0,0,.25)); }
    h1 { margin:0; font-size:26px; letter-spacing:0.2px; }
    .subtitle { margin:6px 0 0; font-size:13px; opacity:0.92; }
    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:16px; margin-top:18px; }
    .card { background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px 18px; border:1px solid rgba(0,0,0,0.05); }
    .section-title { display:flex; align-items:center; gap:10px; margin:0 0 10px; font-size:15px; font-weight:800; color:var(--vinho); }
    .icon { width:18px; height:18px; vertical-align:middle; filter:drop-shadow(0 2px 4px rgba(0,0,0,.15)); }
    ul { margin:6px 0 0 18px; padding:0; } li { margin-bottom:6px; }
    code { background:var(--code-bg); color:#e9edf5; padding:10px 12px; border-radius:10px; display:block; white-space:pre-wrap; font-size:12px; line-height:1.45; box-shadow: inset 0 1px 0 rgba(255,255,255,0.03); }
    .tag { display:inline-block; padding:2px 8px; border-radius:12px; font-size:11px; font-weight:600; background:#eee; color:#555; margin-right:4px; }
    .tag.purple { background:#e0cffc; color:#4a0099; }
    table { width:100%; border-collapse:collapse; font-size:13px; margin-top:10px; }
    th, td { text-align:left; padding:8px; border-bottom:1px solid #eee; }
    th { color:var(--vinho); font-weight:600; }
  </style>
</head>

<svg style="display:none" aria-hidden="true" focusable="false">
  <symbol id="fa-code" viewBox="0 0 640 640"><path opacity=".4" fill="currentColor" d="M225.2 535.2C220.3 552.2 230.2 569.9 247.2 574.8C264.2 579.7 281.9 569.8 286.8 552.8L414.8 104.8C419.7 87.8 409.8 70.1 392.8 65.2C375.8 60.3 358.1 70.2 353.2 87.2L225.2 535.2z"/><path fill="currentColor" d="M457.4 201.4C444.9 213.9 444.9 234.2 457.4 246.7L530.8 320.1L457.4 393.5C444.9 406 444.9 426.3 457.4 438.8C469.9 451.3 490.2 451.3 502.7 438.8L598.7 342.8C611.2 330.3 611.2 310 598.7 297.5L502.7 201.5C490.2 189 469.9 189 457.4 201.5zM182.7 201.4C170.2 188.9 149.9 188.9 137.4 201.4L41.4 297.4C28.9 309.9 28.9 330.2 41.4 342.7L137.4 438.7C149.9 451.2 170.2 451.2 182.7 438.7C195.2 426.2 195.2 405.9 182.7 393.4L109.3 320L182.6 246.6C195.1 234.1 195.1 213.8 182.6 201.3z"/></symbol>
  <symbol id="fa-database" viewBox="0 0 448 512"><path opacity=".4" fill="currentColor" d="M448 80v48c0 44.2-100.3 80-224 80S0 172.2 0 128V80C0 35.8 100.3 0 224 0s224 35.8 224 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.6V288c0 44.2-100.3 80-224 80S0 332.2 0 288V186.1c14.9 11.8 34 21.2 54.8 28.6C99.7 230.7 159.5 240 224 240s124.3-9.3 169.2-25.3zM0 346.1c14.9 11.8 34 21.2 54.8 28.6C99.7 390.7 159.5 400 224 400s124.3-9.3 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.6V432c0 44.2-100.3 80-224 80S0 476.2 0 432V346.1z"/><path fill="currentColor" d="M448 80v48c0 44.2-100.3 80-224 80S0 172.2 0 128V80C0 35.8 100.3 0 224 0s224 35.8 224 80z"/></symbol>
  <symbol id="fa-rectangle-code" viewBox="0 0 640 640"><path opacity=".4" fill="currentColor" d="M32 64C14.3 64 0 78.3 0 96V416c0 17.7 14.3 32 32 32H608c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32H32zM128 320c-17.7 0-32-14.3-32-32s14.3-32 32-32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H128z"/><path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H608c17.7 0 32 14.3 32 32V416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V96zM128 256H224c17.7 0 32 14.3 32 32s-14.3 32-32 32H128c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></symbol>
</svg>

<div class="page">
  <header class="hero">
    <svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-code"></use></svg>
    <div>
      <h1>Abastecimento - Index (Técnico)</h1>
      <p class="subtitle">Detalhes de implementação da página de Gestão · PageModel & JavaScript · Versão 2.0</p>
    </div>
  </header>

  <main class="grid">
    <section class="card">
      <div class="section-title"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-rectangle-code"></use></svg>Index.cshtml.cs (PageModel)</div>
      <p>O backend prepara os dados para os filtros no método <code>OnGet</code>, populando o <code>ViewData</code> para os componentes Syncfusion.</p>
      <code>
public void OnGet() {
    ViewData["Veiculos"] = _uow.Veiculo.GetAll().ToList();
    ViewData["Combustiveis"] = _uow.Combustivel.GetAll().ToList();
    ViewData["Unidades"] = _uow.Unidade.GetAll().ToList();
    // ...
}
      </code>
    </section>

    <section class="card">
      <div class="section-title"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-database"></use></svg>Inicialização DataTable</div>
      <p>Configuração AJAX com 14 colunas e renderizador customizado para o botão de ação.</p>
      <code>
var dataTableAbastecimentos = $('#tblAbastecimentos').DataTable({
    ajax: { url: "/api/abastecimento", type: "GET" },
    columns: [
        { data: "data" }, { data: "placa" },
        // ...
        {
            data: "abastecimentoId",
            render: function (data) {
                return `<a class="btn-acao-km" data-id='${data}'>...</a>`;
            }
        }
    ]
});
      </code>
    </section>

    <section class="card">
      <div class="section-title"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-code"></use></svg>Eventos de Filtro (JS)</div>
      <p>Lógica para destruir e recriar a tabela ao mudar um filtro.</p>
      <code>
change: function(args) {
    if (args.value) {
        // Limpa outros filtros
        unidadesCombo.value = "";
        
        dtDestroySafe(); // Destrói tabela antiga
        
        // Recria com novo endpoint
        var opts = dtCommonOptions();
        opts.ajax = {
            url: "/api/abastecimento/AbastecimentoVeiculos",
            data: { Id: args.value }
        };
        $('#tblAbastecimentos').DataTable(opts);
    }
}
      </code>
    </section>

    <section class="card" style="grid-column: 1 / -1;">
      <div class="section-title"><svg class="icon" aria-hidden="true" focusable="false"><use href="#fa-rectangle-code"></use></svg>Log de Implementação</div>
      <table>
        <thead><tr><th>Versão</th><th>Data</th><th>Alteração</th></tr></thead>
        <tbody>
          <tr><td>2.0</td><td>08/01/2026</td><td>Reescrita no padrão simplificado "Problema -> Solução -> Código".</td></tr>
          <tr><td>1.0</td><td>08/01/2026</td><td>Expansão inicial da documentação técnica.</td></tr>
        </tbody>
      </table>
    </section>
  </main>
</div>
</body>
</html>
