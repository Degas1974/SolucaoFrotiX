# 2026.01.15 - Contexto e Regras

## Resumo Executivo
Inicialização da sessão de trabalho com o Agente Gemini.
Leitura e confirmação das regras de desenvolvimento do projeto FrotiX, incluindo o redirecionamento do `GEMINI.md` para `RegrasDesenvolvimentoFrotiX.md` e a obrigatoriedade de consulta ao `FrotiX.sql`.

## Arquivos Alterados
- `Controllers/AbastecimentoController.cs`: Removido atributo `[BindProperty]` da propriedade `AbastecimentoObj` para corrigir erro de validação em endpoints API.
- `Pages/Abastecimento/Pendencias.cshtml`: Substituído uso direto de `swal()` por `Alerta.Confirmar()` nas funções `excluirPendencia` e `excluirTodasPendencias` para corrigir erro "Cannot call a class as a function".
- `Models/Estatisticas/EstatisticaAbastecimentoMensal.cs`: Alterado `ValorTotal` e `LitrosTotal` para `decimal?` (nullable).
- `Models/Estatisticas/EstatisticaAbastecimentoCombustivel.cs`: Alterado `ValorTotal`, `LitrosTotal` e `MediaValorLitro` para `decimal?` (nullable).
- `Models/Estatisticas/EstatisticaAbastecimentoCategoria.cs`: Alterado `ValorTotal` e `LitrosTotal` para `decimal?` (nullable).
- `Models/Estatisticas/EstatisticaAbastecimentoVeiculo.cs`: Alterado `ValorTotal` e `LitrosTotal` para `decimal?` (nullable).
- `Models/Estatisticas/EstatisticaAbastecimentoVeiculoMensal.cs`: Alterado `ValorTotal` e `LitrosTotal` para `decimal?` (nullable).
- `Models/Estatisticas/EstatisticaAbastecimentoTipoVeiculo.cs`: Alterado `ValorTotal` e `LitrosTotal` para `decimal?` (nullable).
- `Models/Estatisticas/HeatmapAbastecimentoMensal.cs`: Alterado `ValorTotal` para `decimal?` (nullable).
- `Controllers/AbastecimentoController.DashboardAPI.cs`: Atualizadas as queries LINQ em `DashboardDados`, `DashboardMensal`, `DashboardVeiculo` e `DashboardHeatmap` para tratar valores nulos (usando `?? 0`), prevenindo erros de `SqlNullValueException` e mantendo a lógica de negócios.

## Decisões Técnicas
- **Conformidade:** Seguir estritamente as regras consolidadas em `RegrasDesenvolvimentoFrotiX.md`.
- **Banco de Dados:** Consultar `FrotiX.sql` antes de qualquer manipulação.
- **Correção de Bug API:** A remoção do atributo `[BindProperty]` resolveu a validação indesejada no `AtualizaQuilometragem`.
- **Correção de Bug JS:** A substituição de `swal({...})` por `Alerta.Confirmar(...)` resolveu o erro de chamada de classe como função.
- **Correção de Bug Dashboard:** O erro `SqlBuffer.ThrowIfNull` foi corrigido alterando as propriedades dos modelos de estatísticas para `nullable` e ajustando as queries LINQ para usar o operador de coalescência nula (`?? 0`), garantindo que a aplicação trate corretamente registros com valores nulos no banco de dados.